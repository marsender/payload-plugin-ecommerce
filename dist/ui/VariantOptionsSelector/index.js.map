{"version":3,"sources":["../../../src/ui/VariantOptionsSelector/index.tsx"],"sourcesContent":["import type { SelectFieldServerProps } from 'payload'\n\nimport { FieldLabel } from '@payloadcms/ui'\n\nimport { ErrorBox } from './ErrorBox.js'\nimport './index.css'\nimport { OptionsSelect } from './OptionsSelect.js'\ntype Props = {} & SelectFieldServerProps\n\nexport const VariantOptionsSelector: React.FC<Props> = async (props) => {\n  const { clientField, data, path, req, user } = props\n  const { label } = clientField\n\n  const product = await req.payload.findByID({\n    id: data.product,\n    collection: 'products',\n    depth: 0,\n    draft: true,\n    select: {\n      variants: true,\n      variantTypes: true,\n    },\n    user,\n  })\n\n  // @ts-expect-error - TODO: Fix types\n  const existingVariantOptions = product.variants?.docs?.map((variant) => variant.options) ?? []\n\n  const variantTypeIDs = product.variantTypes\n\n  const variantTypes = []\n\n  // Need to get the variant types separately so that the options are populated\n  // @ts-expect-error - TODO: Fix types\n  if (variantTypeIDs?.length && variantTypeIDs.length > 0) {\n    // @ts-expect-error - TODO: Fix types\n    for (const variantTypeID of variantTypeIDs) {\n      const variantType = await req.payload.findByID({\n        id: variantTypeID,\n        collection: 'variantTypes',\n        depth: 1,\n        joins: {\n          options: {\n            sort: 'value',\n          },\n        },\n      })\n\n      if (variantType) {\n        variantTypes.push(variantType)\n      }\n    }\n  }\n\n  return (\n    <div className=\"variantOptionsSelector\">\n      <div className=\"variantOptionsSelectorHeading\">\n        <FieldLabel as=\"span\" label={label} />\n      </div>\n\n      <ErrorBox existingOptions={existingVariantOptions} path={path}>\n        <div className=\"variantOptionsSelectorList\">\n          {variantTypes.map((type) => {\n            // @ts-expect-error - TODO: Fix types\n            const options = type.options.docs.map((option) => ({\n              label: option.label,\n              value: option.id,\n            }))\n\n            return (\n              <OptionsSelect\n                field={clientField}\n                key={type.name}\n                label={type.label || type.name}\n                options={options}\n                path={path}\n              />\n            )\n          })}\n        </div>\n      </ErrorBox>\n    </div>\n  )\n}\n"],"names":["FieldLabel","ErrorBox","OptionsSelect","VariantOptionsSelector","props","clientField","data","path","req","user","label","product","payload","findByID","id","collection","depth","draft","select","variants","variantTypes","existingVariantOptions","docs","map","variant","options","variantTypeIDs","length","variantTypeID","variantType","joins","sort","push","div","className","as","existingOptions","type","option","value","field","name"],"mappings":";AAEA,SAASA,UAAU,QAAQ,iBAAgB;AAE3C,SAASC,QAAQ,QAAQ,gBAAe;AACxC,OAAO,cAAa;AACpB,SAASC,aAAa,QAAQ,qBAAoB;AAGlD,OAAO,MAAMC,yBAA0C,OAAOC;IAC5D,MAAM,EAAEC,WAAW,EAAEC,IAAI,EAAEC,IAAI,EAAEC,GAAG,EAAEC,IAAI,EAAE,GAAGL;IAC/C,MAAM,EAAEM,KAAK,EAAE,GAAGL;IAElB,MAAMM,UAAU,MAAMH,IAAII,OAAO,CAACC,QAAQ,CAAC;QACzCC,IAAIR,KAAKK,OAAO;QAChBI,YAAY;QACZC,OAAO;QACPC,OAAO;QACPC,QAAQ;YACNC,UAAU;YACVC,cAAc;QAChB;QACAX;IACF;IAEA,qCAAqC;IACrC,MAAMY,yBAAyBV,QAAQQ,QAAQ,EAAEG,MAAMC,IAAI,CAACC,UAAYA,QAAQC,OAAO,KAAK,EAAE;IAE9F,MAAMC,iBAAiBf,QAAQS,YAAY;IAE3C,MAAMA,eAAe,EAAE;IAEvB,6EAA6E;IAC7E,qCAAqC;IACrC,IAAIM,gBAAgBC,UAAUD,eAAeC,MAAM,GAAG,GAAG;QACvD,qCAAqC;QACrC,KAAK,MAAMC,iBAAiBF,eAAgB;YAC1C,MAAMG,cAAc,MAAMrB,IAAII,OAAO,CAACC,QAAQ,CAAC;gBAC7CC,IAAIc;gBACJb,YAAY;gBACZC,OAAO;gBACPc,OAAO;oBACLL,SAAS;wBACPM,MAAM;oBACR;gBACF;YACF;YAEA,IAAIF,aAAa;gBACfT,aAAaY,IAAI,CAACH;YACpB;QACF;IACF;IAEA,qBACE,MAACI;QAAIC,WAAU;;0BACb,KAACD;gBAAIC,WAAU;0BACb,cAAA,KAAClC;oBAAWmC,IAAG;oBAAOzB,OAAOA;;;0BAG/B,KAACT;gBAASmC,iBAAiBf;gBAAwBd,MAAMA;0BACvD,cAAA,KAAC0B;oBAAIC,WAAU;8BACZd,aAAaG,GAAG,CAAC,CAACc;wBACjB,qCAAqC;wBACrC,MAAMZ,UAAUY,KAAKZ,OAAO,CAACH,IAAI,CAACC,GAAG,CAAC,CAACe,SAAY,CAAA;gCACjD5B,OAAO4B,OAAO5B,KAAK;gCACnB6B,OAAOD,OAAOxB,EAAE;4BAClB,CAAA;wBAEA,qBACE,KAACZ;4BACCsC,OAAOnC;4BAEPK,OAAO2B,KAAK3B,KAAK,IAAI2B,KAAKI,IAAI;4BAC9BhB,SAASA;4BACTlB,MAAMA;2BAHD8B,KAAKI,IAAI;oBAMpB;;;;;AAKV,EAAC"}